System F, Nominal syntax

\begin{code}%
\>\AgdaKeyword{module} \AgdaModule{Examples.SystemF} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Empty}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Nullary}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{Rel}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Function}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{fold}\AgdaSymbol{;}\AgdaPrimitive{\_*\_}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat.Properties}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{unfold}\AgdaSymbol{;}\AgdaFunction{[\_]}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List.All}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Sum}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Product} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{swap}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality} \AgdaSymbol{as} \AgdaModule{PropEq} \AgdaKeyword{renaming} \AgdaSymbol{(}\AgdaInductiveConstructor{[\_]} \AgdaSymbol{to} \AgdaInductiveConstructor{[\_]ᵢ}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{PropEq.}\AgdaModule{≡-Reasoning} \AgdaKeyword{renaming} \AgdaSymbol{(}\AgdaFunction{begin\_} \AgdaSymbol{to} \AgdaFunction{begin≡\_}\AgdaSymbol{;}\AgdaFunction{\_∎} \AgdaSymbol{to} \AgdaFunction{\_□}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List.Any} \AgdaSymbol{as} \AgdaModule{Any} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{tail}\AgdaSymbol{;}\AgdaFunction{map}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Any.}\AgdaModule{Membership-≡} \AgdaKeyword{hiding} \AgdaSymbol{(}\AgdaFunction{\_⊆\_}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{GPBindings}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Atom}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Swap}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Fresh}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{FreeVariables}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Alpha}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{AlphaInduction}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{OccurBind}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{List.ListProperties}\<%
\\
%
\\
\>\AgdaFunction{SortFTypeVars} \AgdaSymbol{:} \AgdaFunction{Sort}\<%
\\
\>\AgdaFunction{SortFTypeVars} \AgdaSymbol{=} \AgdaNumber{1}\<%
\\
%
\\
\>\AgdaFunction{SortFTermVars} \AgdaSymbol{:} \AgdaFunction{Sort}\<%
\\
\>\AgdaFunction{SortFTermVars} \AgdaSymbol{=} \AgdaNumber{2}\<%
\end{code}

%<*systemF>
\begin{code}%
\>\AgdaFunction{tyF} \AgdaSymbol{:} \AgdaDatatype{Functor} \<[51]%
\>[51]\AgdaComment{-- t,r :-}\<%
\\
\>\AgdaFunction{tyF} \AgdaSymbol{=} \<[11]%
\>[11]\AgdaInductiveConstructor{|v|} \AgdaFunction{SortFTypeVars} \<[51]%
\>[51]\AgdaComment{--   α}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaInductiveConstructor{|+|} \<[11]%
\>[11]\AgdaInductiveConstructor{|R|} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|R|} \<[51]%
\>[51]\AgdaComment{-- | t → r}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaInductiveConstructor{|+|} \<[11]%
\>[11]\AgdaInductiveConstructor{|B|} \AgdaFunction{SortFTypeVars} \AgdaInductiveConstructor{|R|} \<[51]%
\>[51]\AgdaComment{-- | ∀ α . t}\<%
\\
%
\\
\>\AgdaFunction{tF} \AgdaSymbol{:} \AgdaDatatype{Functor} \<[51]%
\>[51]\AgdaComment{-- M,N :-}\<%
\\
\>\AgdaFunction{tF} \AgdaSymbol{=} \<[10]%
\>[10]\AgdaInductiveConstructor{|v|} \AgdaFunction{SortFTermVars} \<[51]%
\>[51]\AgdaComment{--   x}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaInductiveConstructor{|+|} \<[10]%
\>[10]\AgdaInductiveConstructor{|R|} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|R|} \<[51]%
\>[51]\AgdaComment{-- | M N}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaInductiveConstructor{|+|} \<[10]%
\>[10]\AgdaInductiveConstructor{|Ef|} \AgdaFunction{tyF} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|B|} \AgdaFunction{SortFTermVars} \AgdaInductiveConstructor{|R|} \<[51]%
\>[51]\AgdaComment{-- | λ x : t . M}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaInductiveConstructor{|+|} \<[10]%
\>[10]\AgdaInductiveConstructor{|R|} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|Ef|} \AgdaFunction{tyF} \<[51]%
\>[51]\AgdaComment{-- | M t}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaInductiveConstructor{|+|} \<[10]%
\>[10]\AgdaInductiveConstructor{|B|} \AgdaFunction{SortFTypeVars} \AgdaInductiveConstructor{|R|} \<[51]%
\>[51]\AgdaComment{-- | Λ α . M}\<%
\end{code}
%</systemF>

%<*systemFmuty>
\begin{code}%
\>\AgdaFunction{FType} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{FType} \AgdaSymbol{=} \AgdaDatatype{μ} \AgdaFunction{tyF}\<%
\end{code}
%</systemFmuty>

%<*systemFmutrm>
\begin{code}%
\>\AgdaFunction{FTerm} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{FTerm} \AgdaSymbol{=} \AgdaDatatype{μ} \AgdaFunction{tF}\<%
\end{code}
%</systemFmutrm>


\begin{code}%
\>\AgdaFunction{vₜ} \AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FType}\<%
\\
\>\AgdaFunction{vₜ} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨\_⟩} \AgdaFunction{∘} \AgdaInductiveConstructor{inj₁}\<%
\\
%
\\
\>\AgdaFunction{\_⟶\_} \AgdaSymbol{:} \AgdaFunction{FType} \AgdaSymbol{→} \AgdaFunction{FType} \AgdaSymbol{→} \AgdaFunction{FType}\<%
\\
\>\AgdaBound{α} \AgdaFunction{⟶} \AgdaBound{β} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{β}\AgdaSymbol{))} \AgdaInductiveConstructor{⟩} \<[33]%
\>[33]\<%
\\
%
\\
\>\AgdaFunction{∀ₜ} \<[4]%
\>[4]\AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FType} \AgdaSymbol{→} \AgdaFunction{FType}\<%
\\
\>\AgdaFunction{∀ₜ} \AgdaBound{x} \AgdaBound{α} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{α}\AgdaSymbol{))} \AgdaInductiveConstructor{⟩} \<[33]%
\>[33]\<%
\\
%
\\
\>\AgdaFunction{v} \AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaFunction{v} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨\_⟩} \AgdaFunction{∘} \AgdaInductiveConstructor{inj₁}\<%
\\
%
\\
\>\AgdaFunction{\_·\_} \AgdaSymbol{:} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaBound{M} \AgdaFunction{·} \AgdaBound{N} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{))} \AgdaInductiveConstructor{⟩} \<[32]%
\>[32]\<%
\\
%
\\
\>\AgdaFunction{ƛ} \AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FType} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaFunction{ƛ} \AgdaBound{n} \AgdaBound{α} \AgdaBound{M} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{n} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)))} \AgdaInductiveConstructor{⟩}\<%
\\
%
\\
\>\AgdaFunction{\_·ₜ\_} \AgdaSymbol{:} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FType} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaBound{M} \AgdaFunction{·ₜ} \AgdaBound{α} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{α}\AgdaSymbol{))))} \AgdaInductiveConstructor{⟩}\<%
\\
%
\\
\>\AgdaFunction{Λ} \AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaFunction{Λ} \AgdaBound{α} \AgdaBound{M} \AgdaSymbol{=} \AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{))))} \AgdaInductiveConstructor{⟩}\<%
\\
%
\\
\>\AgdaFunction{testswap1} \AgdaSymbol{:} \AgdaFunction{swap} \AgdaFunction{SortFTermVars} \AgdaNumber{1} \AgdaNumber{2} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{)))} \AgdaDatatype{≡} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{2} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{2} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{1}\AgdaSymbol{)))}\<%
\\
\>\AgdaFunction{testswap1} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{testswap2} \AgdaSymbol{:} \AgdaFunction{swap} \AgdaFunction{SortFTypeVars} \AgdaNumber{1} \AgdaNumber{2} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{)))} \AgdaDatatype{≡} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaNumber{2} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{)))}\<%
\\
\>\AgdaFunction{testswap2} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaComment{-- Define function with fold}\<%
\\
\>\AgdaFunction{varsaux} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaDatatype{ℕ} \AgdaSymbol{→} \AgdaDatatype{ℕ}\<%
\\
\>\AgdaFunction{varsaux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{n}\AgdaSymbol{)} \<[44]%
\>[44]\AgdaSymbol{=} \AgdaNumber{1}\<%
\\
\>\AgdaFunction{varsaux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{m} \AgdaInductiveConstructor{,} \AgdaBound{n}\AgdaSymbol{)))} \<[44]%
\>[44]\AgdaSymbol{=} \AgdaBound{m} \AgdaPrimitive{+} \AgdaBound{n}\<%
\\
\>\AgdaFunction{varsaux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(\_} \AgdaInductiveConstructor{,} \AgdaSymbol{\_} \AgdaInductiveConstructor{,} \AgdaBound{m}\AgdaSymbol{))))} \<[44]%
\>[44]\AgdaSymbol{=} \AgdaBound{m}\<%
\\
\>\AgdaFunction{varsaux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{n} \AgdaInductiveConstructor{,} \AgdaSymbol{\_)))))} \AgdaSymbol{=} \AgdaBound{n}\<%
\\
\>\AgdaFunction{varsaux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(\_} \AgdaInductiveConstructor{,} \AgdaBound{m}\AgdaSymbol{)))))} \AgdaSymbol{=} \AgdaBound{m}\<%
\\
%
\\
\>\AgdaFunction{vars} \AgdaSymbol{:} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaDatatype{ℕ}\<%
\\
\>\AgdaFunction{vars} \AgdaSymbol{=} \AgdaFunction{fold} \AgdaFunction{tF} \AgdaFunction{varsaux}\<%
\\
%
\\
\>\AgdaComment{-- Prove trivial property of vars function by primitive induction.}\<%
\\
\>\AgdaFunction{PVars} \AgdaSymbol{:} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{PVars} \AgdaBound{M} \AgdaSymbol{=} \AgdaFunction{vars} \AgdaBound{M} \AgdaFunction{>} \AgdaNumber{0}\<%
\\
%
\\
\>\AgdaFunction{ProvePVars} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{M} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{PVars} \AgdaBound{M}\<%
\\
\>\AgdaFunction{ProvePVars} \AgdaSymbol{=} \AgdaFunction{foldInd} \AgdaFunction{tF} \AgdaFunction{PVars} \AgdaFunction{proof}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{plus>0} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{m} \AgdaFunction{>} \AgdaNumber{0} \AgdaSymbol{→} \AgdaBound{n} \AgdaFunction{>} \AgdaNumber{0} \AgdaSymbol{→} \AgdaBound{m} \AgdaPrimitive{+} \AgdaBound{n} \AgdaFunction{>} \AgdaNumber{0}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{plus>0} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaBound{m>0} \AgdaBound{n>0} \AgdaSymbol{=} \AgdaFunction{≤-steps} \AgdaBound{m} \AgdaBound{n>0}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{proof} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{e} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaSymbol{(}\AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaFunction{fih} \AgdaFunction{tF} \AgdaFunction{PVars} \AgdaBound{e} \AgdaSymbol{→} \AgdaFunction{PVars} \AgdaInductiveConstructor{⟨} \AgdaBound{e} \AgdaInductiveConstructor{⟩}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{proof} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{x}\AgdaSymbol{)} \<[50]%
\>[50]\AgdaBound{tt} \<[61]%
\>[61]\AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{proof} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)))} \<[50]%
\>[50]\AgdaSymbol{(}\AgdaBound{PM} \AgdaInductiveConstructor{,} \AgdaBound{PN}\AgdaSymbol{)} \<[61]%
\>[61]\AgdaSymbol{=} \AgdaFunction{plus>0} \AgdaBound{PM} \AgdaBound{PN}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{proof} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{⟩}\AgdaSymbol{))))} \<[50]%
\>[50]\AgdaSymbol{(}\AgdaBound{tt} \AgdaInductiveConstructor{,} \AgdaBound{PM}\AgdaSymbol{)} \<[61]%
\>[61]\AgdaSymbol{=} \AgdaBound{PM}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{proof} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{,} \AgdaBound{α}\AgdaSymbol{)))))} \<[50]%
\>[50]\AgdaSymbol{(}\AgdaBound{PM} \AgdaInductiveConstructor{,} \AgdaBound{tt}\AgdaSymbol{)} \<[61]%
\>[61]\AgdaSymbol{=} \AgdaBound{PM}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaFunction{proof} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)))))} \<[50]%
\>[50]\AgdaBound{PM} \<[61]%
\>[61]\AgdaSymbol{=} \AgdaBound{PM}\<%
\\
%
\\
\>\AgdaFunction{examplefresh} \AgdaSymbol{:} \AgdaFunction{fresh} \AgdaFunction{SortFTermVars} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{examplefresh} \AgdaSymbol{=} \AgdaInductiveConstructor{freshR} \AgdaSymbol{(}\AgdaInductiveConstructor{freshinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{freshinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{freshinj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{freshx} \AgdaSymbol{(}\AgdaInductiveConstructor{freshEf} \AgdaSymbol{(}\AgdaInductiveConstructor{freshinj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{freshV≢S} \AgdaFunction{1≢2}\AgdaSymbol{)))} \AgdaInductiveConstructor{freshb≡}\AgdaSymbol{))))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{1≢2} \AgdaSymbol{:} \AgdaNumber{1} \AgdaFunction{≢} \AgdaNumber{2}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{1≢2} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{()}\<%
\\
%
\\
\>\AgdaFunction{examplefv} \AgdaSymbol{:} \AgdaFunction{fvS} \AgdaFunction{SortFTermVars} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{)))} \AgdaDatatype{≡} \AgdaNumber{2} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\<%
\\
\>\AgdaFunction{examplefv} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{examplefv2} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaFunction{fvS} \AgdaFunction{SortFTypeVars} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{))))} \AgdaDatatype{≡} \AgdaInductiveConstructor{[]}\<%
\\
\>\AgdaFunction{examplefv2} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{examplefv3} \AgdaSymbol{:} \AgdaFunction{fvS} \AgdaFunction{SortFTypeVars} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{))} \AgdaDatatype{≡} \AgdaNumber{1} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\<%
\\
\>\AgdaFunction{examplefv3} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\end{code}

-- substaux :  (x : V)(t : μ tF)
--             → (e : ⟦ tF ⟧ (μ tF)) 
--             → fihα tF (const (μ tF)) e (x ∷ fv SortFTermVars t) 
--             → μ tF
-- substaux x t' (inj₁ y)                              tt     with x ≟v y
-- ... | yes _                                                      = t'
-- ... | no _                                                       = v y 
-- substaux x t' (inj₂ (inj₁ (t₁ , t₂)))               (hi₁ , hi₂)  = proj₁ hi₁ · proj₁ hi₂
-- substaux x t' (inj₂ (inj₂ (inj₁ (ty , y , t))))     ih           = ƛ y ty (proj₁ (proj₂ (proj₂ ih)))
-- substaux x t' (inj₂ (inj₂ (inj₂ (inj₁ (t , ty)))))  ih           = (proj₁ (proj₁  ih)) ·ₜ  ty
-- substaux x t' (inj₂ (inj₂ (inj₂ (inj₂ (α , t)))))   ih           = Λ α (proj₁ (proj₂ ih))

-- _[_≔_] : FTerm → V → FTerm → FTerm
-- t [ x ≔ t' ] = αIteration (x ∷ fv SortFTermVars t') (substaux x t') t

-- substaux : (x : V)(t : μ tF) → ⟦ tF ⟧ (μ tF) → μ tF
-- substaux x t' (inj₁ y) with x ≟v y
-- ... | yes _                                         = t'
-- ... | no _                                          = v y 
-- substaux x t' (inj₂ (inj₁ (t₁ , t₂)))               = t₁ · t₂
-- substaux x t' (inj₂ (inj₂ (inj₁ (ty , y , t))))     = ƛ y ty t
-- substaux x t' (inj₂ (inj₂ (inj₂ (inj₁ (t , ty)))))  = t ·ₜ  ty
-- substaux x t' (inj₂ (inj₂ (inj₂ (inj₂ (α , t)))))   = Λ α t

-- _[_≔_]ₙ : FTerm → V → FTerm → FTerm
-- t [ x ≔ t' ]ₙ  = fold tF (substaux x t') t

-- _[_≔_] : FTerm → V → FTerm → FTerm
-- t [ x ≔ t' ]   = foldα tF (x ∷ fv SortFTermVars t') (substaux x t') t

\begin{code}%
\>\AgdaKeyword{infix} \AgdaNumber{11} \AgdaFunction{\_[\_≔\_]ₙ}\<%
\\
\>\AgdaKeyword{infix} \AgdaNumber{11} \AgdaFunction{\_[\_≔\_]}\<%
\end{code}

%<*substaux>
\begin{code}%
\>\AgdaFunction{cF} \AgdaSymbol{=} \<[6]%
\>[6]\AgdaInductiveConstructor{|v|} \AgdaFunction{SortFTermVars} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|Ef|} \AgdaFunction{tF}\<%
\\
%
\\
\>\AgdaFunction{substaux} \AgdaSymbol{:} \AgdaDatatype{μ} \AgdaFunction{cF} \AgdaSymbol{→} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaSymbol{(}\AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{μ} \AgdaFunction{tF}\<%
\\
\>\AgdaFunction{substaux} \AgdaSymbol{\_} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t₁} \AgdaInductiveConstructor{,} \AgdaBound{t₂}\AgdaSymbol{)))} \<[59]%
\>[59]\AgdaSymbol{=} \AgdaBound{t₁} \AgdaFunction{·} \AgdaBound{t₂}\<%
\\
\>\AgdaFunction{substaux} \AgdaSymbol{\_} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{ty} \AgdaInductiveConstructor{,} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{))))} \<[59]%
\>[59]\AgdaSymbol{=} \AgdaFunction{ƛ} \AgdaBound{y} \AgdaBound{ty} \AgdaBound{t}\<%
\\
\>\AgdaFunction{substaux} \AgdaSymbol{\_} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{ty}\AgdaSymbol{)))))} \<[59]%
\>[59]\AgdaSymbol{=} \AgdaBound{t} \AgdaFunction{·ₜ} \<[67]%
\>[67]\AgdaBound{ty}\<%
\\
\>\AgdaFunction{substaux} \AgdaSymbol{\_} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{)))))} \<[59]%
\>[59]\AgdaSymbol{=} \AgdaFunction{Λ} \AgdaBound{α} \AgdaBound{t}\<%
\\
\>\AgdaFunction{substaux} \AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \<[16]%
\>[16]\AgdaBound{N} \AgdaInductiveConstructor{⟩} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{y}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[59]%
\>[59]\AgdaSymbol{=} \AgdaBound{N}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \<[59]%
\>[59]\AgdaSymbol{=} \AgdaFunction{v} \AgdaBound{y} \<%
\end{code}
%</substaux>

%<*naivesubst>
\begin{code}%
\>\AgdaFunction{\_[\_≔\_]ₙ} \AgdaSymbol{:} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \<[14]%
\>[14]\AgdaSymbol{=} \AgdaFunction{foldCtx} \AgdaFunction{tF} \AgdaFunction{substaux} \AgdaSymbol{(}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaBound{M}\<%
\end{code}
%</naivesubst>

%<*subst>
\begin{code}%
\>\AgdaFunction{\_[\_≔\_]} \AgdaSymbol{:} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{V} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm}\<%
\\
\>\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]} \<[14]%
\>[14]\AgdaSymbol{=} \AgdaFunction{foldCtx-alpha} \<[31]%
\>[31]\AgdaFunction{tF} \AgdaFunction{substaux} \AgdaSymbol{(}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaBound{M} \<%
\end{code}
%</subst>

\begin{code}%
\>\AgdaComment{-- Examples }\<%
\\
\>\AgdaFunction{exampleSubstn1} \AgdaSymbol{:} \AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{))} \AgdaFunction{[} \AgdaNumber{2} \AgdaFunction{≔} \AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{]ₙ} \AgdaDatatype{≡} \AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{1}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{exampleSubstn1} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{exampleSubst1} \AgdaSymbol{:} \AgdaFunction{Λ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{2}\AgdaSymbol{))} \AgdaFunction{[} \AgdaNumber{2} \AgdaFunction{≔} \AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{]} \AgdaDatatype{≡} \AgdaFunction{Λ} \AgdaNumber{0} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{0} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{0}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{0} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{1}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{exampleSubst1} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{exampleSubst2} \AgdaSymbol{:} \AgdaFunction{Λ} \AgdaNumber{2} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{2} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{2} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{3}\AgdaSymbol{))} \AgdaFunction{[} \AgdaNumber{3} \AgdaFunction{≔} \AgdaFunction{v} \AgdaNumber{1} \AgdaFunction{]} \AgdaDatatype{≡} \AgdaFunction{Λ} \AgdaNumber{0} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaNumber{0} \AgdaSymbol{(}\AgdaFunction{vₜ} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{v} \AgdaNumber{0} \AgdaFunction{·} \AgdaFunction{v} \AgdaNumber{1}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{exampleSubst2} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaKeyword{infix} \AgdaNumber{9} \AgdaFunction{（\_∙\_）\_} \<[15]%
\>[15]\<%
\\
\>\AgdaFunction{（\_∙\_）\_} \AgdaSymbol{=} \AgdaFunction{swap} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaFunction{SortFTermVars}\<%
\end{code}

\begin{code}%
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List.Any} \AgdaSymbol{as} \AgdaModule{any}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{any.}\AgdaModule{Membership-≡}\<%
\\
%
\\
\>\AgdaFunction{lemma-substauxFvS} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{L} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{e} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaSymbol{(}\AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{)\}\{}\AgdaBound{S} \AgdaSymbol{:} \AgdaFunction{Sort}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvSF} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{|R|}\AgdaSymbol{\}} \AgdaBound{S} \AgdaSymbol{(}\AgdaFunction{substaux} \AgdaSymbol{(}\AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaBound{e}\AgdaSymbol{)} \AgdaFunction{⊆} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \AgdaFunction{++} \AgdaFunction{fvSF} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaBound{S} \AgdaBound{e}\<%
\\
\>\AgdaFunction{lemma-substauxFvS} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \<[31]%
\>[31]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{x}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemma-⊆∷} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvSF} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaBound{S} \AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvSF≢} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaInductiveConstructor{[]} \AgdaBound{L}\AgdaSymbol{\}} \<[72]%
\>[72]\AgdaSymbol{\{}\AgdaFunction{fvSF} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{|v|} \AgdaFunction{SortFTermVars}\AgdaSymbol{\}} \AgdaBound{S} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma∈fvSfv} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\})}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \<[12]%
\>[12]\AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFvS} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[31]%
\>[31]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t₁} \AgdaInductiveConstructor{,} \AgdaBound{t₂}\AgdaSymbol{))\}} \<[69]%
\>[69]\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFvS} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[31]%
\>[31]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{ty} \AgdaInductiveConstructor{,} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{)))\}} \<[69]%
\>[69]\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFvS} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[31]%
\>[31]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{ty}\AgdaSymbol{))))\}} \<[69]%
\>[69]\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFvS} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[31]%
\>[31]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{))))\}} \<[69]%
\>[69]\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaFunction{lemma-substauxFv} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{L} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{e} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaSymbol{(}\AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{)\}\{}\AgdaBound{ys} \AgdaSymbol{:} \AgdaDatatype{List} \AgdaFunction{Sort}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>\AgdaComment{--  fvSF≢ \{tF\} \{|R|\} ys (substaux (⟨ y , L ⟩) e) ⊆ fvSF≢ \{cF\} \{|R|\} ys ⟨ y , L ⟩ ++ fvSF≢ \{tF\} \{tF\} ys e}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvSF≢} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{|R|}\AgdaSymbol{\}} \AgdaBound{ys} \AgdaSymbol{(}\AgdaFunction{substaux} \AgdaSymbol{(}\AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaBound{e}\AgdaSymbol{)} \AgdaFunction{⊆} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \<[68]%
\>[68]\AgdaFunction{++} \AgdaFunction{fvSF≢} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaBound{ys} \AgdaBound{e}\<%
\\
\>\AgdaFunction{lemma-substauxFv} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \<[30]%
\>[30]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{x}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemma-⊆∷} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvSF≢} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaBound{ys} \AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvSF≢} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaInductiveConstructor{[]} \AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvSF≢} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{|v|} \AgdaFunction{SortFTermVars}\AgdaSymbol{\}} \AgdaBound{ys} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{fvSF≢⊆} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{[]}\AgdaSymbol{\}} \AgdaSymbol{(λ} \AgdaSymbol{\{}\AgdaBound{\_}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{λ} \AgdaSymbol{()))} \<[159]%
\>[159]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFv} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[30]%
\>[30]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t₁} \AgdaInductiveConstructor{,} \AgdaBound{t₂}\AgdaSymbol{))\}} \<[67]%
\>[67]\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFv} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[30]%
\>[30]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{ty} \AgdaInductiveConstructor{,} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{)))\}} \<[67]%
\>[67]\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFv} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[30]%
\>[30]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{ty}\AgdaSymbol{))))\}} \AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>\AgdaFunction{lemma-substauxFv} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \<[30]%
\>[30]\AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{))))\}} \<[67]%
\>[67]\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{c∈ys→c∈xs++ys} \AgdaSymbol{\{}\AgdaArgument{xs} \AgdaSymbol{=} \AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\end{code}

%<*substauxBinds>
\begin{code}%
\>\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{c} \AgdaSymbol{:} \AgdaDatatype{μ} \AgdaFunction{cF}\AgdaSymbol{\}\{}\AgdaBound{xs} \AgdaSymbol{:} \AgdaDatatype{List} \AgdaFunction{V}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaBound{xs} \AgdaBound{c}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{e} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{ListNotOccurBindF} \AgdaFunction{tF} \AgdaBound{xs} \AgdaBound{e}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaBound{xs} \AgdaSymbol{(}\AgdaFunction{substaux} \AgdaBound{c} \AgdaBound{e}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}} \AgdaBound{xs∉xN} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{y}\AgdaSymbol{\}} \<[81]%
\>[81]\AgdaBound{xs∉e} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \<[77]%
\>[77]\AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaBound{xs∉xN}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemma-bindsR} \AgdaBound{xs∉e}\<%
\\
\>\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}} \AgdaBound{xs∉xN} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{P}\AgdaSymbol{))\}} \<[81]%
\>[81]\AgdaBound{xs∉e} \AgdaSymbol{=} \AgdaFunction{lemma-bindsR} \AgdaBound{xs∉e}\<%
\\
\>\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}} \AgdaBound{xs∉xN} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{ty} \AgdaInductiveConstructor{,} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)))\}} \<[81]%
\>[81]\AgdaBound{xs∉e} \AgdaSymbol{=} \AgdaFunction{lemma-bindsR} \AgdaBound{xs∉e}\<%
\\
\>\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}} \AgdaBound{xs∉xN} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{ty}\AgdaSymbol{))))\}} \<[81]%
\>[81]\AgdaBound{xs∉e} \AgdaSymbol{=} \AgdaFunction{lemma-bindsR} \AgdaBound{xs∉e}\<%
\\
\>\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}} \AgdaBound{xs∉xN} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{))))\}} \<[81]%
\>[81]\AgdaBound{xs∉e} \AgdaSymbol{=} \AgdaFunction{lemma-bindsR} \AgdaBound{xs∉e}\<%
\end{code}
%</substauxBinds>


%<*substauxSwap>
\begin{code}%
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{c} \AgdaSymbol{:} \AgdaDatatype{μ} \AgdaFunction{cF}\AgdaSymbol{\}\{}\AgdaBound{S} \AgdaSymbol{:} \AgdaFunction{Sort}\AgdaSymbol{\}\{}\AgdaBound{y} \AgdaBound{z} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{e} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \<[5]%
\>[5]\AgdaFunction{substaux} \AgdaSymbol{(}\AgdaFunction{swap} \AgdaBound{S} \AgdaBound{y} \AgdaBound{z} \AgdaBound{c}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{swapF} \AgdaFunction{tF} \AgdaBound{S} \AgdaBound{y} \AgdaBound{z} \AgdaBound{e}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaDatatype{≡}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{swap} \AgdaBound{S} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{(}\AgdaFunction{substaux} \AgdaBound{c} \AgdaBound{e}\AgdaSymbol{)}\<%
\end{code}
%</substauxSwap>

\begin{code}%
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaFunction{SortFTermVars} \AgdaFunction{≟S} \AgdaBound{S}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{w}\<%
\\
\>\AgdaSymbol{...} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \<[20]%
\>[20]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[29]%
\>[29]\AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \<[28]%
\>[28]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaKeyword{with} \AgdaBound{z} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[37]%
\>[37]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaSymbol{...} \<[37]%
\>[37]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[43]%
\>[43]\AgdaBound{z≢z} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{z≢z} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡y} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{w≢y} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{x≡w}\AgdaSymbol{)} \AgdaBound{x≡y}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \<[33]%
\>[33]\AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[33]%
\>[33]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{y} \<[55]%
\>[55]\<%
\\
\>\AgdaSymbol{...} \<[43]%
\>[43]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢y} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡w} \AgdaBound{w≡y}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \<[33]%
\>[33]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[52]%
\>[52]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡z} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{y} \<[74]%
\>[74]\<%
\\
\>\AgdaSymbol{...} \<[62]%
\>[62]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[71]%
\>[71]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaSymbol{...} \<[62]%
\>[62]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{y≢y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{y≢y} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \<[33]%
\>[33]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[58]%
\>[58]\AgdaBound{w≢z} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{w≢z} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{x≡w}\AgdaSymbol{)} \AgdaBound{x≡z}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \<[33]%
\>[33]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[39]%
\>[39]\AgdaBound{x≢z} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{y} \<[55]%
\>[55]\<%
\\
\>\AgdaSymbol{...} \<[43]%
\>[43]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢y} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡w} \AgdaBound{w≡y}\AgdaSymbol{))} \<[87]%
\>[87]\<%
\\
\>\AgdaSymbol{...} \<[43]%
\>[43]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[49]%
\>[49]\AgdaBound{w≢y} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[53]%
\>[53]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡z} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢z} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡w} \AgdaBound{w≡z}\AgdaSymbol{))} \<[97]%
\>[97]\<%
\\
\>\AgdaSymbol{...} \<[53]%
\>[53]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢z} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{w}\<%
\\
\>\AgdaSymbol{...} \<[62]%
\>[62]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaInductiveConstructor{refl} \<[80]%
\>[80]\<%
\\
\>\AgdaSymbol{...} \<[62]%
\>[62]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢w} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaBound{x≡w}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \AgdaKeyword{with} \AgdaFunction{SortFTermVars} \AgdaFunction{≟S} \AgdaBound{S}\<%
\\
\>\AgdaSymbol{...} \<[22]%
\>[22]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[28]%
\>[28]\AgdaBound{SortFTermVars≢S} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{SortFTermVars≢S} \AgdaBound{SortFTermVars≡S}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \<[22]%
\>[22]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \<[30]%
\>[30]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡y} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \<[40]%
\>[40]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡y} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{w≡y}\AgdaSymbol{)))}\<%
\\
\>\AgdaSymbol{...} \<[40]%
\>[40]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[46]%
\>[46]\AgdaBound{w≢y} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[51]%
\>[51]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡z} \AgdaKeyword{with} \AgdaBound{z} \AgdaFunction{≟v} \AgdaBound{y} \<[73]%
\>[73]\<%
\\
\>\AgdaSymbol{...} \<[61]%
\>[61]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{z≡y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡y} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{z≡y}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{w≡z}\AgdaSymbol{))))}\<%
\\
\>\AgdaSymbol{...} \<[61]%
\>[61]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{z≢y} \<[71]%
\>[71]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \<[35]%
\>[35]\<%
\\
\>[3]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡y} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \<[51]%
\>[51]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢z} \<[61]%
\>[61]\AgdaKeyword{with} \AgdaBound{z} \AgdaFunction{≟v} \AgdaBound{w}\<%
\\
\>\AgdaSymbol{...} \<[62]%
\>[62]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{z≡w} \AgdaSymbol{=} \<[75]%
\>[75]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{w≢z} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{z≡w}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{...} \<[62]%
\>[62]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \AgdaSymbol{=} \<[72]%
\>[72]\AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[51]%
\>[51]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \<[61]%
\>[61]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡y} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y≡z} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡z} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{y≡z}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{w≡y}\AgdaSymbol{))))}\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{y≢z} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡z} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡z} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{w≡z}\AgdaSymbol{)))}\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢z} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{w}\<%
\\
\>\AgdaSymbol{...} \<[80]%
\>[80]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y≡w} \AgdaSymbol{=} \<[93]%
\>[93]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{w≢y} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{y≡w}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{...} \<[80]%
\>[80]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{y≢w} \AgdaSymbol{=} \<[92]%
\>[92]\AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[58]%
\>[58]\AgdaBound{x≢z} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{y} \<[74]%
\>[74]\<%
\\
\>\AgdaSymbol{...} \<[61]%
\>[61]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡y} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaSymbol{=} \<[84]%
\>[84]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢z} \AgdaBound{x≡z}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[58]%
\>[58]\AgdaBound{x≢z} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \AgdaKeyword{with} \AgdaBound{w} \AgdaFunction{≟v} \AgdaBound{z} \<[83]%
\>[83]\<%
\\
\>\AgdaSymbol{...} \<[71]%
\>[71]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{w≡z} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \<[81]%
\>[81]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡y} \AgdaSymbol{=} \<[94]%
\>[94]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢y} \AgdaBound{x≡y}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \<[81]%
\>[81]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[31]%
\>[31]\AgdaBound{x≢w} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[58]%
\>[58]\AgdaBound{x≢z} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢y} \<[72]%
\>[72]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{w≢z} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{w}\<%
\\
\>\AgdaSymbol{...} \<[81]%
\>[81]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \AgdaSymbol{=} \<[94]%
\>[94]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaBound{x≡w}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \<[81]%
\>[81]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{w}\AgdaSymbol{\}} \<[84]%
\>[84]\<%
\\
\>[3]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{SortFTermVars≢S} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{w}\<%
\\
\>\AgdaSymbol{...} \<[14]%
\>[14]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡w} \<[25]%
\>[25]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaSymbol{...} \<[14]%
\>[14]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[20]%
\>[20]\AgdaSymbol{\_} \<[25]%
\>[25]\AgdaKeyword{with} \AgdaFunction{SortFTermVars} \AgdaFunction{≟S} \AgdaBound{S}\<%
\\
\>\AgdaSymbol{...} \<[26]%
\>[26]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{SortFTermVars≡S} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{SortFTermVars≢S} \AgdaBound{SortFTermVars≡S}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \<[26]%
\>[26]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{e} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{M'}\AgdaSymbol{))\}} \<[80]%
\>[80]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{e} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{w} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)))\}} \<[80]%
\>[80]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{e} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{))))\}} \<[80]%
\>[80]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{e} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{))))\}} \<[80]%
\>[80]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{lemma-[]Swap} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaFunction{swap} \AgdaFunction{SortFTermVars} \AgdaBound{y} \AgdaBound{z} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaFunction{（} \AgdaBound{y} \AgdaFunction{∙} \AgdaBound{z} \AgdaFunction{）ₐ} \AgdaBound{x} \AgdaFunction{≔} \AgdaFunction{swap} \AgdaFunction{SortFTermVars} \AgdaBound{y} \AgdaBound{z} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>[2]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaDatatype{≡}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{swap} \AgdaFunction{SortFTermVars} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-[]Swap} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemmaSwapFoldCtxEquiv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{SortFTermVars}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{(λ} \AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\})}\<%
\\
\>\<%
\end{code}

%<*substlemma1>
\begin{code}%
\>\AgdaFunction{lemma-substα} \AgdaSymbol{:} \<[16]%
\>[16]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M′} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{∼α} \AgdaBound{M′} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]} \AgdaDatatype{≡} \AgdaBound{M′} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]}\<%
\\
\>\AgdaFunction{lemma-substα} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M′}\AgdaSymbol{\}} \AgdaBound{M∼M′}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemma-foldCtxα-StrongαCompatible} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaBound{M′} \AgdaBound{M∼M′}\<%
\end{code}
%</substlemma1>

\begin{code}%
\>\<%
\end{code}

%<*lemmasubstaux>
\begin{code}%
\>\AgdaFunction{lemma-substaux} \<[16]%
\>[16]\AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{e} \AgdaBound{e′} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaSymbol{(}\AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{)\}\{}\AgdaBound{c} \AgdaBound{c′} \AgdaSymbol{:} \<[49]%
\>[49]\AgdaDatatype{μ} \AgdaFunction{cF}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{→} \AgdaBound{c} \AgdaFunction{∼α} \AgdaBound{c′}\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{→} \AgdaDatatype{∼αF} \AgdaFunction{tF} \AgdaBound{e} \AgdaBound{e′}\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{→} \AgdaFunction{substaux} \AgdaBound{c} \AgdaBound{e} \AgdaFunction{∼α} \AgdaFunction{substaux} \AgdaBound{c′} \AgdaBound{e′}\<%
\end{code}
%</lemmasubstaux>

\begin{code}%
\>\AgdaFunction{lemma-substaux} \AgdaSymbol{\{}\AgdaInductiveConstructor{inj₁} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αR} \AgdaSymbol{\{}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaSymbol{.}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{⟨} \AgdaBound{N′} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaInductiveConstructor{∼αV} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αEf} \AgdaBound{N∼N′}\AgdaSymbol{)))} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaInductiveConstructor{∼αV}\AgdaSymbol{)} \<[89]%
\>[89]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y} \<[14]%
\>[14]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[63]%
\>[63]\AgdaSymbol{=} \<[66]%
\>[66]\AgdaInductiveConstructor{∼αR} \AgdaBound{N∼N′}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \<[63]%
\>[63]\AgdaSymbol{=} \<[66]%
\>[66]\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaInductiveConstructor{∼αV}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-substaux} \AgdaSymbol{\_} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \<[30]%
\>[30]\AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{e∼e′} \AgdaBound{e∼e′₁}\AgdaSymbol{)))} \<[63]%
\>[63]\AgdaSymbol{=} \<[66]%
\>[66]\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \<[83]%
\>[83]\AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{e∼e′} \AgdaBound{e∼e′₁}\AgdaSymbol{)))}\<%
\\
\>\AgdaFunction{lemma-substaux} \AgdaSymbol{\_} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{e∼e′} \AgdaBound{e∼e′₁}\AgdaSymbol{))))} \<[63]%
\>[63]\AgdaSymbol{=} \<[66]%
\>[66]\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{e∼e′} \AgdaBound{e∼e′₁}\AgdaSymbol{))))}\<%
\\
\>\AgdaFunction{lemma-substaux} \AgdaSymbol{\_} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{e∼e′} \AgdaBound{e∼e′₁}\AgdaSymbol{)))))} \<[63]%
\>[63]\AgdaSymbol{=} \<[66]%
\>[66]\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{e∼e′} \AgdaBound{e∼e′₁}\AgdaSymbol{)))))}\<%
\\
\>\AgdaFunction{lemma-substaux} \AgdaSymbol{\_} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \<[42]%
\>[42]\AgdaSymbol{(}\AgdaInductiveConstructor{∼αB} \AgdaBound{xs} \AgdaBound{x₁}\AgdaSymbol{)))))} \<[63]%
\>[63]\AgdaSymbol{=} \<[66]%
\>[66]\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \<[95]%
\>[95]\AgdaSymbol{(}\AgdaInductiveConstructor{∼αB} \AgdaBound{xs} \AgdaBound{x₁}\AgdaSymbol{)))))}\<%
\\
%
\\
\>\AgdaFunction{lemma-substnα′} \AgdaSymbol{:} \<[18]%
\>[18]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{N′} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{18}{}\<[18]%
\>[18]\AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{∼α} \AgdaBound{N′} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{∼α} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \AgdaFunction{]ₙ}\<%
\\
\>\AgdaFunction{lemma-substnα′} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αR} \AgdaBound{N∼N′}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemma-foldCtx-alpha-Ctx} \AgdaFunction{lemma-substaux} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaInductiveConstructor{∼αV} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αEf} \AgdaBound{N∼N′}\AgdaSymbol{)))} \AgdaBound{M}\<%
\end{code}

%<*substlemma2>
\begin{code}%
\>\AgdaFunction{lemma-substα′} \AgdaSymbol{:} \<[17]%
\>[17]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{N′} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{∼α} \AgdaBound{N′} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]} \AgdaFunction{∼α} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \AgdaFunction{]}\<%
\\
\>\AgdaFunction{lemma-substα′} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αR} \AgdaBound{N∼N′}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemma-foldCtxalpha-cxtalpha} \AgdaFunction{lemma-substaux} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaInductiveConstructor{∼αV} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αEf} \AgdaBound{N∼N′}\AgdaSymbol{)))} \AgdaBound{M}\<%
\end{code}
%</substlemma2>

\begin{code}%
\>\AgdaFunction{fv2ctx} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{)} \AgdaBound{M} \<[63]%
\>[63]\AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>\AgdaFunction{fv2ctx} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaBound{nb} \AgdaSymbol{=} \AgdaBound{nb}\<%
\end{code}

%<*lemmasubsts>
\begin{code}%
\>\AgdaFunction{lemmaSubsts} \AgdaSymbol{:} \<[15]%
\>[15]\AgdaSymbol{\{}\AgdaBound{z} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{z} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{z} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]} \AgdaFunction{∼α} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{z} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>\AgdaFunction{lemmaSubsts} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaBound{nb}\<%
\\
\> \AgdaSymbol{=} \AgdaFunction{lemma-foldCtxAlpha-foldCtx}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaFunction{tF} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{z} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{lemma-substaux}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(λ} \AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{lemma-substauxSwap} \AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\})}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(}\AgdaFunction{fv2ctx} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaBound{nb}\AgdaSymbol{)}\<%
\end{code}
%</lemmasubsts>

\begin{code}%
\>\AgdaComment{-- \{- Previous lemma could also be proved by simple induction on terms -\}}\<%
\\
\>\AgdaComment{-- substα′2 : (x : V)(t t′ t″ : FTerm) → t′ ∼α t″ → t [ x ≔ t′ ] ∼α t [ x ≔ t″ ]}\<%
\\
\>\AgdaComment{-- substα′2 x t t′ t″ t′∼t″ }\<%
\\
\>\AgdaComment{--   with x ∷ fv SortFTermVars t′ | x ∷ fv SortFTermVars t″ | cong (\_∷\_ x) (lemma∼fv' SortFTermVars t′∼t″)}\<%
\\
\>\AgdaComment{-- ... | fvt′ | .fvt′ | refl }\<%
\\
\>\AgdaComment{--   with proj₁ (bindersFreeαElem fvt′ t)}\<%
\\
\>\AgdaComment{-- ... | e }\<%
\\
\>\AgdaComment{--   = foldInd tF (λ t → t′ ∼α t″ → fold tF (substaux x t′) t ∼α fold tF (substaux x t″) t) substα′aux e t′∼t″}\<%
\\
\>\AgdaComment{--   where}\<%
\\
\>\AgdaComment{--   substα′aux  : (e : ⟦ tF ⟧ (μ tF))}\<%
\\
\>\AgdaComment{--               → fih tF (λ t₁ → t′ ∼α t″ → fold tF (substaux x t′) t₁ ∼α fold tF (substaux x t″) t₁) e}\<%
\\
\>\AgdaComment{--               → t′ ∼α t″ → fold tF (substaux x t′) ⟨ e ⟩ ∼α fold tF (substaux x t″) ⟨ e ⟩}\<%
\\
\>\AgdaComment{--   substα′aux (inj₁ y)                                  \_            t′∼t″}\<%
\\
\>\AgdaComment{--       with x ≟v y }\<%
\\
\>\AgdaComment{--   ... | yes \_ = t′∼t″}\<%
\\
\>\AgdaComment{--   ... | no  \_ = ∼αR (∼α+₁ ∼αV)}\<%
\\
\>\AgdaComment{--   substα′aux (inj₂ (inj₁ (⟨ t₁ ⟩ , ⟨ t₂ ⟩)))           (hi₁ , hi₂)  t′∼t″}\<%
\\
\>\AgdaComment{--     = ∼αR (∼α+₂ (∼α+₁ (∼αx (hi₁ t′∼t″) (hi₂ t′∼t″))))}\<%
\\
\>\AgdaComment{--   substα′aux (inj₂ (inj₂ (inj₁ (ty , x , ⟨ t ⟩))))     (\_ , hi)     t′∼t″}\<%
\\
\>\AgdaComment{--     = ∼αR (∼α+₂ (∼α+₂ (∼α+₁ (∼αx ρF (∼αB [] ( λ c c∉[] → lemma∼swapEquiv2 (hi  t′∼t″) x c)))))) --}\<%
\\
\>\AgdaComment{--   substα′aux (inj₂ (inj₂ (inj₂ (inj₁ (⟨ t ⟩ , ty)))))  (hi , \_)     t′∼t″}\<%
\\
\>\AgdaComment{--     = ∼αR (∼α+₂ (∼α+₂ (∼α+₂ (∼α+₁ (∼αx (hi t′∼t″) ρF))))) --}\<%
\\
\>\AgdaComment{--   substα′aux (inj₂ (inj₂ (inj₂ (inj₂ (α , ⟨ t ⟩)))))   hi           t′∼t″}\<%
\\
\>\AgdaComment{--     = ∼αR (∼α+₂ (∼α+₂ (∼α+₂ (∼α+₂ (∼αB [] (λ c c∉[] → lemma∼swapEquiv2 (hi  t′∼t″) α c)))))) --}\<%
\\
%
\\
\>\AgdaComment{-- -- substauxty : (x : V)(ty : FType)}\<%
\\
\>\AgdaComment{-- --       (e : ⟦ tF ⟧ (μ tF))}\<%
\\
\>\AgdaComment{-- --       → fihα tF (const (μ tF)) e (x ∷ fv SortFTypeVars ty)}\<%
\\
\>\AgdaComment{-- --       → μ tF}\<%
\\
\>\AgdaComment{-- -- substauxty x ty e fihα = \{!!\}}\<%
\\
%
\\
\>\AgdaComment{-- -- \_[\_≔\_]ₜ : FTerm → V → FType → FTerm}\<%
\\
\>\AgdaComment{-- -- t [ x ≔ ty ]ₜ = αIteration (x ∷ fv SortFTypeVars ty) (substauxty x ty) t}\<%
\\
%
\\
\>\AgdaFunction{lemma-substnfv} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{∉} \AgdaFunction{fvS} \AgdaFunction{SortFTermVars} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{notOccurBind} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{≡} \AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>\AgdaFunction{lemma-substnfv} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₁} \AgdaBound{y} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \<[54]%
\>[54]\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x∉fvy} \AgdaSymbol{\_} \<[70]%
\>[70]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡y} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{((}\AgdaFunction{b∉a∷xs→b≢a} \AgdaBound{x∉fvy}\AgdaSymbol{)} \AgdaBound{x≡y}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{x≢y} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-substnfv} \<[16]%
\>[16]\AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{M′}\AgdaSymbol{))} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \<[54]%
\>[54]\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x∉fv} \<[67]%
\>[67]\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBR} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBx} \AgdaBound{xnbM} \AgdaBound{xnbM′}\AgdaSymbol{))))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin≡}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaBound{M} \AgdaFunction{·} \AgdaBound{M′}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≡⟨} \AgdaFunction{cong₂} \AgdaFunction{\_·\_} \<[19]%
\>[19]\AgdaSymbol{(}\AgdaFunction{lemma-substnfv} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \<[41]%
\>[41]\AgdaSymbol{(}\AgdaFunction{c∉xs++ys→c∉xs} \AgdaBound{x∉fv}\AgdaSymbol{)} \AgdaBound{xnbM}\AgdaSymbol{)}\<%
\\
\>[5]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaSymbol{(}\AgdaFunction{lemma-substnfv} \AgdaSymbol{\{}\AgdaBound{M′}\AgdaSymbol{\}} \<[41]%
\>[41]\AgdaSymbol{(}\AgdaFunction{c∉xs++ys→c∉ys} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvS} \AgdaFunction{SortFTermVars} \<[80]%
\>[80]\AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{x∉fv}\AgdaSymbol{)} \AgdaBound{xnbM′}\AgdaSymbol{)} \<[98]%
\>[98]\AgdaFunction{⟩}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{·} \AgdaSymbol{(}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≡⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{·} \AgdaBound{M′}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{□}\<%
\\
\>\AgdaFunction{lemma-substnfv} \<[16]%
\>[16]\AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)))} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \<[54]%
\>[54]\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x∉fv} \<[67]%
\>[67]\<%
\\
\>[5]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBR} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \<[59]%
\>[59]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBx} \AgdaSymbol{\_} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBB≢} \AgdaBound{x≢y} \AgdaBound{xnbM}\AgdaSymbol{))))))} \<[116]%
\>[116]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin≡}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{ƛ} \AgdaBound{y} \AgdaBound{t} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≡⟨} \AgdaFunction{cong} \AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaBound{y} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-substnfv} \<[38]%
\>[38]\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}}\<%
\\
\>[5]\AgdaIndent{38}{}\<[38]%
\>[38]\AgdaSymbol{(}\AgdaFunction{lemma-∉} \<[48]%
\>[48]\AgdaSymbol{(}\AgdaFunction{sym≢} \AgdaBound{x≢y}\AgdaSymbol{)}\<%
\\
\>[38]\AgdaIndent{48}{}\<[48]%
\>[48]\AgdaSymbol{(}\AgdaFunction{c∉xs++ys→c∉ys} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fvSF} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{|Ef|} \AgdaFunction{tyF}\AgdaSymbol{\}} \AgdaFunction{SortFTermVars} \AgdaBound{t}\AgdaSymbol{\}} \AgdaBound{x∉fv}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{38}{}\<[38]%
\>[38]\AgdaBound{xnbM}\AgdaSymbol{)} \<[45]%
\>[45]\AgdaFunction{⟩} \<[48]%
\>[48]\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{ƛ} \AgdaBound{y} \AgdaBound{t} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≡⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩} \<[20]%
\>[20]\<%
\\
\>[5]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaBound{y} \AgdaBound{t} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{□}\<%
\\
\>\AgdaFunction{lemma-substnfv} \<[16]%
\>[16]\AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{))))} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x∉fv}\<%
\\
\>[5]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBR} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \<[59]%
\>[59]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBx} \AgdaBound{xnbM} \AgdaSymbol{\_))))))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin≡}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaBound{M} \AgdaFunction{·ₜ} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{≡⟨} \<[10]%
\>[10]\AgdaFunction{cong} \AgdaSymbol{(λ} \AgdaBound{P} \AgdaSymbol{→} \<[23]%
\>[23]\AgdaBound{P} \AgdaFunction{·ₜ} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-substnfv} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{c∉xs++ys→c∉xs} \AgdaBound{x∉fv}\AgdaSymbol{)} \AgdaBound{xnbM}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{·ₜ} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{≡⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{·ₜ} \AgdaBound{t}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{□}\<%
\\
\>\AgdaFunction{lemma-substnfv} \<[16]%
\>[16]\AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{α} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{))))} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x∉fv}\<%
\\
\>[6]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBR} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \<[59]%
\>[59]\AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBinj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBB≢} \AgdaBound{x≢α} \AgdaBound{xnbM}\AgdaSymbol{))))))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin≡}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{Λ} \AgdaBound{α} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≡⟨} \AgdaFunction{cong} \AgdaSymbol{(}\AgdaFunction{Λ} \AgdaBound{α}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-substnfv} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{x∉fv} \AgdaBound{xnbM}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{Λ} \AgdaBound{α} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≡⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaFunction{Λ} \AgdaBound{α} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{□}\<%
\end{code}

%<*substnaivecompositionpredicate>
\begin{code}%
\>\AgdaFunction{PSCn} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{L} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaFunction{FTerm} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{PSCn} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{N} \AgdaBound{M} \AgdaSymbol{=} \<[24]%
\>[24]\AgdaBound{x} \AgdaFunction{∉} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L} \AgdaSymbol{→} \<[40]%
\>[40]\AgdaBound{x} \AgdaFunction{notOccurBind} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \<[5]%
\>[5]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{∼α} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\<%
\end{code}
%</substnaivecompositionpredicate>

\begin{code}%
\>\AgdaFunction{lemma-substCompositionV} \<[25]%
\>[25]\AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{N} \AgdaBound{L} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{25}{}\<[25]%
\>[25]\AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{∉} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \<[39]%
\>[39]\AgdaBound{L}\<%
\\
\>[2]\AgdaIndent{25}{}\<[25]%
\>[25]\AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{notOccurBind} \AgdaBound{L}\<%
\\
\>[2]\AgdaIndent{25}{}\<[25]%
\>[25]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaFunction{v} \AgdaBound{z}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{∼α} \AgdaSymbol{(}\AgdaFunction{v} \AgdaBound{z}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ} \<[97]%
\>[97]\<%
\\
\>\AgdaFunction{lemma-substCompositionV} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{x∉yfvL} \AgdaSymbol{\_} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{z} \<[26]%
\>[26]\<%
\\
\>\AgdaSymbol{...} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y≡z} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{((}\AgdaFunction{b∉a∷xs→b≢a} \AgdaBound{x∉yfvL}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{trans} \AgdaBound{x≡z} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaBound{y≡z}\AgdaSymbol{)))}\<%
\\
\>\AgdaSymbol{...} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[18]%
\>[18]\AgdaBound{y≢z} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[22]%
\>[22]\AgdaSymbol{|} \<[25]%
\>[25]\AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaFunction{ρ}\<%
\\
\>\AgdaSymbol{...} \<[22]%
\>[22]\AgdaSymbol{|} \<[25]%
\>[25]\AgdaInductiveConstructor{no} \<[29]%
\>[29]\AgdaBound{x≢z} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢z} \AgdaBound{x≡z}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-substCompositionV} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{x≢z} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟v} \AgdaBound{z} \<[26]%
\>[26]\<%
\\
\>\AgdaSymbol{...} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y≡z}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{subst} \<[11]%
\>[11]\AgdaSymbol{(λ} \AgdaBound{M} \AgdaSymbol{→} \<[19]%
\>[19]\AgdaBound{L} \AgdaFunction{∼α} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{(}\AgdaFunction{lemma-substnfv} \AgdaSymbol{(}\AgdaFunction{lemma∉fvfvS} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{SortFTermVars}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{b∉a∷xs→b∉xs} \AgdaBound{x∉yfvL}\AgdaSymbol{))} \AgdaBound{xnbL}\AgdaSymbol{)} \AgdaFunction{ρ} \<[95]%
\>[95]\<%
\\
\>\AgdaSymbol{...} \<[12]%
\>[12]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[18]%
\>[18]\AgdaBound{y≢z} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟v} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \<[22]%
\>[22]\AgdaSymbol{|} \<[25]%
\>[25]\AgdaInductiveConstructor{yes} \AgdaBound{x≡z} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢z} \AgdaBound{x≡z}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \<[22]%
\>[22]\AgdaSymbol{|} \<[25]%
\>[25]\AgdaInductiveConstructor{no} \<[29]%
\>[29]\AgdaSymbol{\_} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaFunction{ρ}\<%
\\
%
\\
\>\AgdaComment{-- Esto puede demostrarse genericamente usando fold fusion !}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{∼-Reasoning}\AgdaSymbol{(}\AgdaFunction{tF}\AgdaSymbol{)}\<%
\\
\>\<%
\end{code}

%<*substcompositionNdef>
\begin{code}%
\>\AgdaFunction{lemma-substCompositionN} \AgdaSymbol{:} \<[27]%
\>[27]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{L} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{PSCn} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{N} \AgdaBound{M}\<%
\\
\>\AgdaFunction{lemma-substCompositionN} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{foldInd} \AgdaFunction{tF} \AgdaSymbol{(}\AgdaFunction{PSCn} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{N}\AgdaSymbol{)} \AgdaFunction{lemma-substCompositionNAux} \AgdaBound{M}\<%
\end{code}
%</substcompositionNdef>

\begin{code}%
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-substCompositionNAux} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{e} \AgdaSymbol{:} \AgdaFunction{⟦} \AgdaFunction{tF} \AgdaFunction{⟧} \AgdaSymbol{(}\AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaFunction{fih} \AgdaFunction{tF} \AgdaSymbol{(}\AgdaFunction{PSCn} \AgdaBound{N}\AgdaSymbol{)} \AgdaBound{e} \AgdaSymbol{→} \AgdaFunction{PSCn} \AgdaBound{N} \AgdaInductiveConstructor{⟨} \AgdaBound{e} \AgdaInductiveConstructor{⟩} \<[87]%
\>[87]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-substCompositionNAux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{z}\AgdaSymbol{)} \AgdaSymbol{\_} \AgdaBound{x∉yfvL} \AgdaBound{xnbL} \AgdaSymbol{=} \AgdaFunction{lemma-substCompositionV} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-substCompositionNAux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M′} \<[46]%
\>[46]\AgdaInductiveConstructor{,} \AgdaBound{M″} \AgdaSymbol{)))} \AgdaSymbol{(}\AgdaBound{hiM′} \AgdaInductiveConstructor{,} \AgdaBound{hiM″}\AgdaSymbol{)} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \<[8]%
\>[8]\AgdaFunction{begin}\<%
\\
\>[4]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaBound{M′} \AgdaFunction{·} \<[17]%
\>[17]\AgdaBound{M″} \AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[8]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{((}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{·} \<[30]%
\>[30]\AgdaSymbol{(}\AgdaBound{M″} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{))} \<[48]%
\>[48]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[8]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{·} \<[40]%
\>[40]\AgdaSymbol{(}\AgdaBound{M″} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{∼⟨} \<[12]%
\>[12]\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaSymbol{(}\AgdaBound{hiM′} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{hiM″} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\AgdaSymbol{))))} \AgdaFunction{⟩}\<%
\\
\>[8]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ} \AgdaSymbol{)} \AgdaFunction{·} \<[52]%
\>[52]\AgdaSymbol{(}\AgdaBound{M″} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[8]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaBound{M′} \AgdaFunction{·} \<[17]%
\>[17]\AgdaBound{M″}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ} \<[54]%
\>[54]\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{∎}\<%
\end{code}

%<*substncompositionabstractioncase>
\begin{code}%
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-substCompositionNAux} \<[30]%
\>[30]\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{z} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{))))}\<%
\\
\>[2]\AgdaIndent{30}{}\<[30]%
\>[30]\AgdaSymbol{(\_} \AgdaInductiveConstructor{,} \AgdaBound{hiM}\AgdaSymbol{)} \AgdaBound{x∉yfvL} \AgdaBound{x∉bL} \AgdaSymbol{=} \<[55]%
\>[55]\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{begin}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaBound{z} \AgdaBound{t} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \<[52]%
\>[52]\AgdaFunction{⟩}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{ƛ} \AgdaBound{z} \AgdaBound{t} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{∼⟨} \AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \<[18]%
\>[18]\AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁}\<%
\\
\>[4]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \<[15]%
\>[15]\AgdaFunction{ρF} \AgdaSymbol{(}\AgdaFunction{lemma∼+B} \AgdaSymbol{(}\AgdaBound{hiM} \AgdaBound{x∉yfvL} \AgdaBound{x∉bL}\AgdaSymbol{))))))} \<[52]%
\>[52]\AgdaFunction{⟩} \<[54]%
\>[54]\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{ƛ} \AgdaBound{z} \AgdaBound{t} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \<[52]%
\>[52]\AgdaFunction{⟩}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{(}\AgdaFunction{ƛ} \AgdaBound{z} \AgdaBound{t} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{∎}\<%
\end{code}
%</substncompositionabstractioncase>

\begin{code}%
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-substCompositionNAux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{t}\AgdaSymbol{)))))} \AgdaSymbol{(}\AgdaBound{hi} \AgdaInductiveConstructor{,} \AgdaSymbol{\_)} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \<[7]%
\>[7]\AgdaFunction{begin}\<%
\\
\>[4]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{·ₜ} \AgdaBound{t}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[7]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{·ₜ} \AgdaBound{t} \<[40]%
\>[40]\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{∼⟨} \AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₁} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaSymbol{(}\AgdaBound{hi} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\AgdaSymbol{)} \AgdaFunction{ρF}\AgdaSymbol{)))))} \AgdaFunction{⟩}\<%
\\
\>[7]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\AgdaSymbol{)} \AgdaFunction{·ₜ} \AgdaBound{t} \<[51]%
\>[51]\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[7]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{·ₜ} \AgdaBound{t}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{∎}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-substCompositionNAux} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)))))} \AgdaBound{hi} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \<[7]%
\>[7]\AgdaFunction{begin}\<%
\\
\>[4]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaFunction{Λ} \AgdaBound{t} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaFunction{Λ} \AgdaBound{t} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{∼⟨} \AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼α+₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αB} \AgdaInductiveConstructor{[]} \AgdaSymbol{(λ} \AgdaBound{c} \AgdaBound{c∉[]} \AgdaSymbol{→} \AgdaFunction{lemma∼swapEquiv} \AgdaSymbol{(}\AgdaBound{hi} \AgdaBound{x∉yfvL} \AgdaBound{xnbL}\AgdaSymbol{)} \AgdaBound{t} \AgdaBound{c}\AgdaSymbol{))))))} \AgdaFunction{⟩}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaFunction{Λ} \AgdaBound{t} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{≈⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaFunction{Λ} \AgdaBound{t} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{∎}\<%
\end{code}




Composition Lemma (exemplifies alpha induction principle usage)



--lemma-substComposition' :  {x y : V}{M N L : FTerm} → PSC {x} {y} {L} N M 
--lemma-substComposition' {x} {y} {M} {N} {L} p∉ = {!!}
\end{code}

%<*substcompositionpredicate>
\begin{code}%
\>\AgdaFunction{TreeFTermF} \AgdaSymbol{=} \<[14]%
\>[14]\AgdaInductiveConstructor{|Ef|} \AgdaFunction{tF} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|Ef|} \AgdaFunction{tF} \AgdaInductiveConstructor{|x|} \AgdaInductiveConstructor{|Ef|} \AgdaFunction{tF} \<[46]%
\>[46]\<%
\\
\>\AgdaFunction{TreeFTerm} \AgdaSymbol{=} \AgdaDatatype{μ} \AgdaFunction{TreeFTermF}\<%
\\
%
\\
\>\AgdaFunction{PSComp} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{TreeFTerm} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{PSComp} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \AgdaSymbol{=} \AgdaBound{x} \AgdaFunction{∉} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]}\AgdaSymbol{)} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]} \AgdaFunction{∼α} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\AgdaSymbol{)}\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]} \AgdaFunction{]}\<%
\end{code}
%</substcompositionpredicate>


%<*substcompositionpredicatealpha>
\begin{code}%
\>\AgdaFunction{αCompatiblePSComp} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{αCompatiblePred} \AgdaSymbol{\{}\AgdaFunction{TreeFTermF}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{PSComp} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\})}\<%
\\
\>\AgdaFunction{αCompatiblePSComp} \<[19]%
\>[19]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{M′} \AgdaInductiveConstructor{,} \AgdaBound{N′} \AgdaInductiveConstructor{,} \AgdaBound{L′} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \<[62]%
\>[62]\<%
\\
\>[4]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaSymbol{(}\AgdaInductiveConstructor{∼αR} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{M∼M′} \AgdaSymbol{(}\AgdaInductiveConstructor{∼αx} \AgdaBound{N∼N′} \AgdaBound{L∼L′}\AgdaSymbol{)))} \AgdaBound{PMs} \AgdaBound{x∉y:fvL′}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M′} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[36]%
\>[36]\AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Strong α compability of inner substitution operation       }\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≈⟨} \AgdaFunction{cong} \AgdaSymbol{(λ} \AgdaBound{z} \AgdaSymbol{→} \AgdaBound{z} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \AgdaFunction{]}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-substα} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaFunction{M∼M'}\AgdaSymbol{))} \<[90]%
\>[90]\AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[36]%
\>[36]\AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Strong α compability of outter substitution operation       }\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≈⟨} \AgdaFunction{lemma-substα} \<[22]%
\>[22]\AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-substα′} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaFunction{N∼N'}\AgdaSymbol{))} \<[90]%
\>[90]\AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[36]%
\>[36]\AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Outter substitution is alpha-compatible in its substituted argument}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∼⟨} \AgdaFunction{lemma-substα′} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[39]%
\>[39]\AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaFunction{L∼L'}\AgdaSymbol{)} \<[90]%
\>[90]\AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[36]%
\>[36]\AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Application of the inductive hypothesis}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∼⟨} \AgdaBound{PMs} \AgdaFunction{x∉y∶fvL} \<[90]%
\>[90]\AgdaFunction{⟩} \<[92]%
\>[92]\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[36]%
\>[36]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[46]%
\>[46]\AgdaFunction{]} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Strong α compability of inner substitution operation       }\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≈⟨} \AgdaFunction{cong} \<[14]%
\>[14]\AgdaSymbol{(λ} \AgdaBound{P} \AgdaSymbol{→} \AgdaBound{P} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]} \AgdaFunction{]}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-substα} \AgdaFunction{M∼M'}\AgdaSymbol{)} \<[90]%
\>[90]\AgdaFunction{⟩} \<[92]%
\>[92]\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M′} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[36]%
\>[36]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[46]%
\>[46]\AgdaFunction{]} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Inner substitution is alpha-compatible in its substituted argument}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≈⟨} \AgdaFunction{lemma-substα} \<[23]%
\>[23]\AgdaSymbol{\{}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\<%
\\
\>[5]\AgdaIndent{23}{}\<[23]%
\>[23]\AgdaSymbol{(}\AgdaFunction{lemma-substα′} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M′}\AgdaSymbol{\}} \AgdaFunction{L∼L'}\AgdaSymbol{)} \<[90]%
\>[90]\AgdaFunction{⟩} \<[99]%
\>[99]\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M′} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[36]%
\>[36]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[46]%
\>[46]\AgdaFunction{]} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Strong α compability of substitution operation in subsituted term       }\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{≈⟨} \AgdaFunction{cong} \<[14]%
\>[14]\AgdaSymbol{(λ} \AgdaBound{P} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{M′} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \AgdaFunction{]}\AgdaSymbol{)} \<[38]%
\>[38]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{P} \AgdaFunction{]}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-substα} \AgdaFunction{N∼N'}\AgdaSymbol{)} \<[90]%
\>[90]\AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M′} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \<[36]%
\>[36]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[46]%
\>[46]\AgdaFunction{]} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaComment{-- Outter substitution is alpha-compatible in its substituted argument}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∼⟨} \AgdaFunction{lemma-substα′} \<[23]%
\>[23]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M′} \<[32]%
\>[32]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N′} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-substα′} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N′}\AgdaSymbol{\}} \AgdaFunction{L∼L'}\AgdaSymbol{)} \<[90]%
\>[90]\AgdaFunction{⟩} \<[92]%
\>[92]\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M′} \<[12]%
\>[12]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N′} \<[36]%
\>[36]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L′} \<[46]%
\>[46]\AgdaFunction{]} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∎} \<[11]%
\>[11]\<%
\end{code}
%</substcompositionpredicatealpha>

\begin{code}%
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x∉y∶fvL} \AgdaSymbol{:} \AgdaBound{x} \AgdaFunction{∉} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x∉y∶fvL} \AgdaSymbol{=} \AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{xs} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{∉} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaBound{xs}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma∼fv} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaSymbol{(}\AgdaFunction{lemma-∼αEf} \AgdaBound{L∼L′}\AgdaSymbol{)))} \AgdaBound{x∉y:fvL′}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{M∼M'} \AgdaSymbol{=} \AgdaFunction{lemma-∼αEf} \AgdaBound{M∼M′}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{N∼N'} \AgdaSymbol{=} \AgdaFunction{lemma-∼αEf} \AgdaBound{N∼N′}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{L∼L'} \AgdaSymbol{=} \AgdaFunction{lemma-∼αEf} \AgdaBound{L∼L′}\<%
\end{code}


%<*substitutioncompositionproof>
\begin{code}%
\>\AgdaFunction{alpha-proof} \AgdaSymbol{:} \<[15]%
\>[15]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}(}\AgdaBound{Ms} \AgdaSymbol{:} \AgdaDatatype{μ} \AgdaFunction{TreeFTermF}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \AgdaBound{Ms} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{Ms}\AgdaSymbol{)} \AgdaBound{Ms} \AgdaSymbol{→} \AgdaFunction{PSComp} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{Ms}\<%
\\
\>\AgdaFunction{alpha-proof} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \AgdaBound{nOcc} \AgdaBound{nOcc2} \AgdaBound{x∉y∶fvL}\<%
\\
\>[2]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaSymbol{=} \<[6]%
\>[6]\AgdaFunction{begin}\<%
\\
\>[3]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{≈⟨} \AgdaFunction{lemma-substα} \<[23]%
\>[23]\AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemmaSubsts} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaFunction{x:fvN∉bM}\AgdaSymbol{)} \<[80]%
\>[80]\AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{∼⟨} \AgdaFunction{lemmaSubsts} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaFunction{y:fvL∉bM[x≔N]ₙ} \<[80]%
\>[80]\AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{∼⟨} \AgdaFunction{lemma-substCompositionN} \<[34]%
\>[34]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaBound{x∉y∶fvL} \AgdaFunction{x∉bL} \<[80]%
\>[80]\AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \<[46]%
\>[46]\AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{∼⟨} \AgdaFunction{lemma-substnα′} \<[25]%
\>[25]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaSymbol{(}\AgdaFunction{lemmaSubsts} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaFunction{y:fvL∉bN}\AgdaSymbol{))} \<[80]%
\>[80]\AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]} \<[46]%
\>[46]\AgdaFunction{]ₙ}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{∼⟨} \AgdaFunction{σ} \AgdaSymbol{(}\AgdaFunction{lemmaSubsts} \<[25]%
\>[25]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\AgdaSymbol{\}} \AgdaFunction{x:fvN[y≔L]∉bM[y≔L]ₙ}\AgdaSymbol{)} \<[80]%
\>[80]\AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]} \<[46]%
\>[46]\AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{≈⟨} \AgdaFunction{lemma-substα} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaSymbol{(}\AgdaFunction{lemmaSubsts} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaFunction{y:fvL∉bM}\AgdaSymbol{))} \<[80]%
\>[80]\AgdaFunction{⟩}\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaBound{M} \<[13]%
\>[13]\AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \<[22]%
\>[22]\AgdaFunction{]}\AgdaSymbol{)} \<[26]%
\>[26]\AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]} \<[46]%
\>[46]\AgdaFunction{]}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaFunction{∎}\<%
\end{code}
%</substitutioncompositionproof>

\begin{code}%
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bM,N,L} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{\{}\AgdaFunction{TreeFTermF}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{M} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{N} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bM,N,L} \AgdaSymbol{=} \AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{xs} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaBound{xs} \AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemmafvtern} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\})} \AgdaBound{nOcc2}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bM} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{M} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{N} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bM}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₁inv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaFunction{fvM++fvN++fvL∉bM,N,L}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bN} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{M} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{N} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bN}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₁inv} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaFunction{fvM++fvN++fvL∉bM,N,L}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bL} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{M} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{N} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvM++fvN++fvL∉bL}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaFunction{fvM++fvN++fvL∉bM,N,L}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:y∉bM} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:y∉bM} \AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₁inv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaBound{nOcc}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:y∉bN} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:y∉bN} \AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₁inv} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaBound{nOcc}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:y∉bL} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:y∉bL} \AgdaSymbol{=} \AgdaFunction{lemmalistNotOccurBindEf→ListNotOccurBindR} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \AgdaSymbol{(}\AgdaFunction{listNotOccurBx₂inv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindF} \AgdaBound{nOcc}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:fvN∉bM} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \<[39]%
\>[39]\AgdaBound{N}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:fvN∉bM} \AgdaSymbol{=} \AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaFunction{x:y∉bM}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-binds++l} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{fvM++fvN++fvL∉bM}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x∉bL} \AgdaSymbol{:} \AgdaBound{x} \AgdaFunction{notOccurBind} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x∉bL} \AgdaSymbol{=} \AgdaFunction{lemma-binds:head} \AgdaFunction{x:y∉bL}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y:fvL∉bM} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y:fvL∉bM} \AgdaSymbol{=} \AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaSymbol{(}\AgdaFunction{lemma-binds:tail} \AgdaFunction{x:y∉bM}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{fvM++fvN++fvL∉bM}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y:fvL∉bN} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y:fvL∉bN} \AgdaSymbol{=} \AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaSymbol{(}\AgdaFunction{lemma-binds:tail} \AgdaFunction{x:y∉bN}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{fvM++fvN++fvL∉bN}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y:fvL∉bM[x≔N]ₙ} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y:fvL∉bM[x≔N]ₙ}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \AgdaFunction{lemma-foldCtxBinds} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{(}\AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBR} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBx} \AgdaInductiveConstructor{notOccurBv} \AgdaSymbol{(}\AgdaFunction{notOccurBindR→notOccurBindEf} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaFunction{y:fvL∉bN}\AgdaSymbol{))))} \AgdaSymbol{(}\AgdaFunction{lemma-bindsR} \AgdaSymbol{(}\AgdaFunction{lemma-binds×} \AgdaFunction{lemma-bindsv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindEf} \AgdaSymbol{(}\AgdaFunction{lemma-binds:tail} \AgdaFunction{y:fvL∉bN}\AgdaSymbol{))))))} \AgdaFunction{y:fvL∉bM} \<[313]%
\>[313]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{[x]∉bM[y≔L]ₙ} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{[x]∉bM[y≔L]ₙ} \AgdaSymbol{=} \AgdaFunction{lemma-foldCtxBinds} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{(}\AgdaFunction{lemma-bindsR} \AgdaSymbol{(} \AgdaFunction{lemma-binds×} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBv} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \AgdaSymbol{(} \AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindEf} \AgdaSymbol{(} \AgdaFunction{lemma-binds:cons} \<[195]%
\>[195]\AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaFunction{x:y∉bL}\AgdaSymbol{)} \AgdaInductiveConstructor{[]}\AgdaSymbol{)))))} \AgdaSymbol{(}\AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaFunction{x:y∉bM} \AgdaSymbol{)} \AgdaInductiveConstructor{[]}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fv⟨y,L⟩∉bM} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{L} \AgdaSymbol{:} \AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{M} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fv⟨y,L⟩∉bM} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaBound{y:fvL∉bM} \AgdaSymbol{=} \AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaBound{y:fvL∉bM}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-binds:tail} \AgdaBound{y:fvL∉bM}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y∉bL} \AgdaSymbol{:} \AgdaBound{y} \AgdaFunction{notOccurBind} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y∉bL} \AgdaSymbol{=} \AgdaFunction{lemma-binds:head} \AgdaSymbol{(}\AgdaFunction{lemma-binds:tail} \AgdaFunction{x:y∉bL}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvL∉bL} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{L}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvL∉bL} \AgdaSymbol{=} \AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{fvM++fvN++fvL∉bL}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fv⟨y,L⟩∉b⟨y,L⟩} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{L} \AgdaSymbol{:} \AgdaDatatype{μ} \AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{y} \AgdaFunction{notOccurBind} \AgdaBound{L} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaBound{L}\AgdaSymbol{)} \AgdaBound{L} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}}\AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{)} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fv⟨y,L⟩∉b⟨y,L⟩} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaBound{y∉bL} \AgdaBound{fvL∉bL} \AgdaSymbol{=} \AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBR} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBx} \AgdaInductiveConstructor{notOccurBv} \AgdaSymbol{(}\AgdaInductiveConstructor{notOccurBEf} \AgdaSymbol{(}\AgdaFunction{notOccurBRinv} \AgdaBound{y∉bL}\AgdaSymbol{))))} \AgdaSymbol{((}\AgdaFunction{lemma-bindsR} \AgdaSymbol{(}\AgdaFunction{lemma-binds×} \AgdaFunction{lemma-bindsv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindEf} \AgdaBound{fvL∉bL}\AgdaSymbol{))))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvN[y≔L]ₙ∉bM[y≔L]ₙ} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaFunction{fv} \AgdaSymbol{(}\AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fvN[y≔L]ₙ∉bM[y≔L]ₙ}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \AgdaFunction{lemma-binds⊆} \<[20]%
\>[20]\AgdaSymbol{\{}\AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩} \AgdaFunction{++} \AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaSymbol{(}\AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)\}}\<%
\\
\>[4]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaSymbol{(}\AgdaFunction{foldCtxFV} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaSymbol{(λ} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{lemma-substauxFv} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\})} \AgdaSymbol{(λ} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{lemma-substauxFvS} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{e}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}))}\<%
\\
\>[4]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaSymbol{(}\AgdaFunction{lemma-binds++} \<[36]%
\>[36]\AgdaSymbol{\{}\AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{N}\AgdaSymbol{\}}\<%
\\
\>[20]\AgdaIndent{36}{}\<[36]%
\>[36]\AgdaSymbol{(}\AgdaFunction{lemma-foldCtxBinds} \<[57]%
\>[57]\AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaInductiveConstructor{⟨} \AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{(}\AgdaFunction{fv⟨y,L⟩∉b⟨y,L⟩} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaFunction{y∉bL} \AgdaFunction{fvL∉bL}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{fv⟨y,L⟩∉bM} \AgdaSymbol{\{}\AgdaBound{L}\AgdaSymbol{\}} \AgdaFunction{y:fvL∉bM}\AgdaSymbol{))}\<%
\\
\>[20]\AgdaIndent{36}{}\<[36]%
\>[36]\AgdaSymbol{(}\AgdaFunction{lemma-foldCtxBinds} \<[57]%
\>[57]\AgdaSymbol{\{}\AgdaFunction{cF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{tF}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{substaux}\AgdaSymbol{\}}\<%
\\
\>[36]\AgdaIndent{57}{}\<[57]%
\>[57]\AgdaSymbol{(}\AgdaFunction{lemma-substauxBinds} \AgdaSymbol{(}\AgdaFunction{lemma-bindsR} \AgdaSymbol{(} \AgdaFunction{lemma-binds×} \AgdaFunction{lemma-bindsv} \AgdaSymbol{(}\AgdaFunction{lemmalistNotOccurBindFR→ListNotOccurBindEf} \AgdaSymbol{(}\AgdaFunction{lemma-binds++l} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{fvM++fvN++fvL∉bL}\AgdaSymbol{))))))}\<%
\\
\>[36]\AgdaIndent{57}{}\<[57]%
\>[57]\AgdaSymbol{(}\AgdaFunction{lemma-binds++l} \AgdaSymbol{(}\AgdaFunction{lemma-binds++r} \AgdaSymbol{\{}\AgdaFunction{fv} \AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{fvM++fvN++fvL∉bM}\AgdaSymbol{))))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:fvN[y≔L]ₙ∉bM[y≔L]ₙ} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaSymbol{(}\AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:fvN[y≔L]ₙ∉bM[y≔L]ₙ} \AgdaSymbol{=} \AgdaFunction{lemma-binds:cons} \AgdaSymbol{(}\AgdaFunction{lemma-binds:head} \AgdaFunction{[x]∉bM[y≔L]ₙ}\AgdaSymbol{)} \AgdaFunction{fvN[y≔L]ₙ∉bM[y≔L]ₙ}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:fvN[y≔L]∉bM[y≔L]ₙ} \AgdaSymbol{:} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaFunction{fv} \AgdaSymbol{(}\AgdaBound{N} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{x:fvN[y≔L]∉bM[y≔L]ₙ} \AgdaSymbol{=} \AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{xs} \AgdaSymbol{→} \AgdaFunction{ListNotOccurBind} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{xs}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{[} \AgdaBound{y} \AgdaFunction{≔} \AgdaBound{L} \AgdaFunction{]ₙ}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{lemma∼fv} \AgdaSymbol{(}\AgdaFunction{σ} \AgdaSymbol{(}\AgdaFunction{lemmaSubsts} \AgdaFunction{y:fvL∉bN}\AgdaSymbol{)))} \AgdaFunction{x:fvN[y≔L]ₙ∉bM[y≔L]ₙ}\<%
\end{code}

%<*substcompalphaproof>
\begin{code}%
\>\AgdaFunction{lemma-substComposition2} \<[25]%
\>[25]\AgdaSymbol{:} \<[28]%
\>[28]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{Ms} \AgdaSymbol{:} \AgdaFunction{TreeFTerm}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{PSComp} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{Ms}\<%
\\
\>\AgdaFunction{lemma-substComposition2} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\AgdaSymbol{\}}\<%
\\
\> \AgdaSymbol{=} \AgdaFunction{alphaProof} \<[15]%
\>[15]\AgdaSymbol{(}\AgdaFunction{PSComp} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\})} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{y} \AgdaInductiveConstructor{∷} \AgdaInductiveConstructor{[]}\AgdaSymbol{)} \<[45]%
\>[45]\<%
\\
\>[2]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{(}\AgdaFunction{αCompatiblePSComp} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\})}\<%
\\
\>[2]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaFunction{alpha-proof}\<%
\\
\>[2]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaInductiveConstructor{⟨} \AgdaBound{M} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaInductiveConstructor{,} \AgdaBound{L} \AgdaInductiveConstructor{⟩}\<%
\end{code}
%</substcompalphaproof>



Parallel Reduction

\begin{code}%
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Relation} \AgdaFunction{FTerm} \<[36]%
\>[36]\<%
\\
\>\AgdaKeyword{infix} \AgdaNumber{7} \AgdaDatatype{\_⇉n\_}\<%
\end{code}

\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{\_⇉n\_} \AgdaSymbol{:} \AgdaFunction{Rel} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⇉nv} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaFunction{v} \AgdaBound{x} \AgdaDatatype{⇉n} \AgdaFunction{v} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⇉nƛ} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{t} \AgdaSymbol{:} \AgdaFunction{FType}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaBound{N}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaFunction{ƛ} \AgdaBound{x} \AgdaBound{t} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaFunction{ƛ} \AgdaBound{x} \AgdaBound{t} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⇉n·} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaBound{N} \AgdaBound{N'} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{N} \AgdaDatatype{⇉n} \AgdaBound{N'}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{·} \AgdaBound{N} \AgdaDatatype{⇉n} \AgdaBound{M'} \AgdaFunction{·} \AgdaBound{N'}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⇉n·ₜ} \AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{t} \AgdaSymbol{:} \AgdaFunction{FType}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaBound{N}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{·ₜ} \AgdaBound{t} \AgdaDatatype{⇉n} \AgdaBound{N} \AgdaFunction{·ₜ} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⇉nΛ} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaBound{N}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaFunction{Λ} \AgdaBound{α} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaFunction{Λ} \AgdaBound{α} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⇉nβ} \AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaBound{N} \AgdaBound{N'} \AgdaBound{P} \AgdaSymbol{:} \AgdaFunction{FTerm}\AgdaSymbol{\}\{}\AgdaBound{t} \AgdaSymbol{:} \AgdaFunction{FType}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{⇉n} \AgdaBound{M'} \<[19]%
\>[19]\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{N} \AgdaDatatype{⇉n} \AgdaBound{N'}\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaFunction{ƛ} \AgdaBound{x} \AgdaBound{t} \AgdaBound{M} \AgdaFunction{·} \AgdaBound{N} \AgdaDatatype{⇉n} \AgdaBound{M'} \AgdaFunction{[} \AgdaBound{x} \AgdaFunction{≔} \AgdaBound{N'} \AgdaFunction{]ₙ}\<%
\end{code}

All lemmas about ⇉n relation must have freshness premises so naive substitution behaves correctly

-- \begin{code}%
\>\AgdaComment{-- FourFTermF =  |Ef| tF |x| |Ef| tF |x| |Ef| tF |x| |Ef| tF }\<%
\\
\>\AgdaComment{-- FourFTerm = μ FourFTermF}\<%
\\
%
\\
\>\AgdaComment{-- lemma-⇉SubstN :  \{x : V\}\{M M' N N' : FTerm \}}\<%
\\
\>\AgdaComment{--                  → ListNotOccurBind \{FourFTermF\}}\<%
\\
\>\AgdaComment{--                       (x ∷ fv \{FourFTermF\} ⟨ M , M' , N , N' ⟩)}\<%
\\
\>\AgdaComment{--                       ⟨ M , M' , N , N' ⟩}\<%
\\
\>\AgdaComment{--                  → M ⇉n M' → N ⇉n N'}\<%
\\
\>\AgdaComment{--                  → M [ x ≔ N ]ₙ ⇉n M' [ x ≔ N' ]ₙ}\<%
\\
\>\AgdaComment{-- lemma-⇉SubstN = \{!!\}}\<%
\\
%
\\
\>\AgdaComment{-- diam⇉n :  \{M N P : FTerm\} → ListNotOccurBind (fv M) M}\<%
\\
\>\AgdaComment{--           → M ⇉n N → M ⇉n P → ∃ (λ R → N ⇉n R × P ⇉n R)}\<%
\\
\>\AgdaComment{-- diam⇉n = \{!!\}}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- infix 7 \_⇉\_}\<%
\\
%
\\
\>\AgdaComment{-- bvcFTerm : FTerm → FTerm}\<%
\\
\>\AgdaComment{-- bvcFTerm M = proj₁ (bindersFreeαElem (fv M) M)}\<%
\\
%
\\
\>\AgdaComment{-- \_⇉\_ : Rel}\<%
\\
\>\AgdaComment{-- M ⇉ N = ∃ (λ N' → M' ⇉n N' × N' ∼α N)}\<%
\\
\>\AgdaComment{--   where}\<%
\\
\>\AgdaComment{--   M' = bvcFTerm M}\<%
\\
%
\\
\>\AgdaComment{-- lemma-⇉rightα : \{M N P : FTerm\} → M ⇉ N → N ∼α P → M ⇉ P}\<%
\\
\>\AgdaComment{-- lemma-⇉rightα \{P = P\} (N' , M'⇉N' , N'∼N) N∼P =  N' , M'⇉N' , τ N'∼N N∼P}\<%
\\
%
\\
\>\AgdaComment{-- lemma-⇉leftα : \{M N P : FTerm\} → P ∼α M → M ⇉ N → P ⇉ N}\<%
\\
\>\AgdaComment{-- lemma-⇉leftα \{M\} \{N\} \{P\} P∼M M⇉N}\<%
\\
\>\AgdaComment{--   with bvcFTerm P | bvcFTerm M | lemma-bindersFreeαFV P∼M}\<%
\\
\>\AgdaComment{-- ... | M' | .M' | refl  = M⇉N}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}


-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- ρ⇉ : Reflexive (\_⇉\_)}\<%
\\
\>\AgdaComment{-- ρ⇉ = \{!!\}}\<%
\\
%
\\
\>\AgdaComment{-- τ⇉ : Transitive (\_⇉\_)}\<%
\\
\>\AgdaComment{-- τ⇉ = \{!!\} }\<%
\\
%
\\
\>\AgdaComment{-- module ⇉-Reasoning where}\<%
\\
\>\AgdaComment{--   ⇉-preorder : Preorder \_ \_ \_}\<%
\\
\>\AgdaComment{--   ⇉-preorder =  }\<%
\\
\>\AgdaComment{--              record \{ }\<%
\\
\>\AgdaComment{--              Carrier = FTerm;}\<%
\\
\>\AgdaComment{--              \_≈\_ = \_≡\_;}\<%
\\
\>\AgdaComment{--              \_∼\_ = \_⇉\_;}\<%
\\
\>\AgdaComment{--              isPreorder =  record \{}\<%
\\
\>\AgdaComment{--              isEquivalence = Relation.Binary.Setoid.isEquivalence (setoid FTerm) ;}\<%
\\
\>\AgdaComment{--              reflexive = λ \{ \{M\} \{.M\} refl → ρ⇉\};}\<%
\\
\>\AgdaComment{--              trans = τ⇉ \} \}}\<%
\\
%
\\
\>\AgdaComment{--   import Relation.Binary.PreorderReasoning as PreR⇉}\<%
\\
\>\AgdaComment{--   open PreR⇉ ⇉-preorder renaming (begin\_ to begin⇉\_;\_∼⟨\_⟩\_ to \_⇉⟨\_⟩\_;\_≈⟨\_⟩\_ to \_⇉≈⟨\_⟩\_;\_∎ to \_∎⇉) public}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

-- Ctx can be done generically

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- data ctx (r : Rel) : Rel where}\<%
\\
\>\AgdaComment{--   ctxinj : ∀ \{t t'\}       → r t t'        → ctx r t t'}\<%
\\
\>\AgdaComment{--   ctx·l  : ∀ \{t₁ t₁' t₂\}  → ctx r t₁ t₁'  → ctx r (t₁ · t₂)   (t₁' · t₂)}\<%
\\
\>\AgdaComment{--   ctx·r  : ∀ \{t₁ t₂ t₂'\}  → ctx r t₂ t₂'  → ctx r (t₁ · t₂)   (t₁ · t₂')}\<%
\\
\>\AgdaComment{--   ctx·ₜ  : ∀ \{t₁ t₁' t₂\}  → ctx r t₁ t₁'  → ctx r (t₁ ·ₜ t₂)  (t₁' ·ₜ t₂)}\<%
\\
\>\AgdaComment{--   ctxƛ   : ∀ \{x t t₁ t₁'\} → ctx r t₁ t₁'  → ctx r (ƛ x t t₁)  (ƛ x t t₁')}\<%
\\
\>\AgdaComment{--   ctxΛ   : ∀ \{t t₁ t₁'\}   → ctx r t₁ t₁'  → ctx r (Λ t t₁)    (Λ t t₁')}\<%
\\
%
\\
\>\AgdaComment{-- infix 1 \_▹\_ }\<%
\\
\>\AgdaComment{-- data \_▹\_ : Rel where}\<%
\\
\>\AgdaComment{--   ▹β  :  \{M N : FTerm\}\{x : V\}\{t : FType\} }\<%
\\
\>\AgdaComment{--       →  ƛ x t M · N ▹ M [ x ≔ N ]}\<%
\\
%
\\
\>\AgdaComment{-- infix 4 \_→β\_}\<%
\\
\>\AgdaComment{-- \_→β\_ : Rel}\<%
\\
\>\AgdaComment{-- \_→β\_ = ctx \_▹\_}\<%
\\
%
\\
\>\AgdaComment{-- infix 4 \_→α\_ }\<%
\\
\>\AgdaComment{-- \_→α\_ : Rel}\<%
\\
\>\AgdaComment{-- \_→α\_ = \_→β\_ ∪ \_∼α\_}\<%
\\
%
\\
\>\AgdaComment{-- infix 4 \_→α*\_}\<%
\\
\>\AgdaComment{-- \_→α*\_ : Rel}\<%
\\
\>\AgdaComment{-- \_→α*\_ = star \_→α\_}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

-- \begin{code}%
\>\<%
\\
%
\\
\>\AgdaComment{-- -- This 3 results are what I need !}\<%
\\
%
\\
\>\AgdaComment{-- lemma→α⊆⇉ : \_→α\_ ⊆ \_⇉\_}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₁ (ctxinj (▹β \{M\}))) = \{! ⇉β ρ⇉ ρ⇉!\}}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₁ (ctx·l x))   = \{!!\}}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₁ (ctx·r x))   = \{!!\}}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₁ (ctx·ₜ x))   = \{!!\}}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₁ (ctxƛ x₁))   = \{!!\}}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₁ (ctxΛ x))    = \{!!\}}\<%
\\
\>\AgdaComment{-- lemma→α⊆⇉ (inj₂ (∼αR y))     = \{!!\}}\<%
\\
%
\\
\>\AgdaComment{-- lemma⇉⊆→α* : \_⇉\_ ⊆ \_→α*\_}\<%
\\
\>\AgdaComment{-- lemma⇉⊆→α* = \{!!\}}\<%
\\
%
\\
\>\AgdaComment{-- diam⇉ : diamond \_⇉\_}\<%
\\
\>\AgdaComment{-- diam⇉ = \{!!\}}\<%
\\
%
\\
\>\AgdaComment{-- lemma-CR⇉ : cr \_⇉\_}\<%
\\
\>\AgdaComment{-- lemma-CR⇉ = diamond-cr diam⇉}\<%
\\
\>\AgdaComment{-- --}\<%
\\
\>\AgdaComment{-- lemma-CR→α : cr \_→α\_}\<%
\\
\>\AgdaComment{-- lemma-CR→α = cr-⊆ lemma→α⊆⇉ lemma⇉⊆→α* lemma-CR⇉}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}




-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- open ⇉-Reasoning}\<%
\\
%
\\
\>\AgdaComment{-- Psubst⇉ : \{N N' : FTerm\}(x : V) → FTerm → Set}\<%
\\
\>\AgdaComment{-- Psubst⇉ \{N\} \{N'\} x M = \{M' : FTerm\} → M ⇉ M' → N ⇉ N' → M [ x ≔ N ] ⇉ M' [ x ≔ N' ]}\<%
\\
%
\\
\>\AgdaComment{-- αCompP⇉[] : \{N N' : FTerm\}(x : V) → αCompatiblePred (Psubst⇉ \{N\} \{N'\} x)}\<%
\\
\>\AgdaComment{-- αCompP⇉[] \{N\} \{N'\} x \{M\} \{P\} M∼P P⇉[]M \{M'\} P⇉M' N⇉N' }\<%
\\
\>\AgdaComment{--   =  begin⇉}\<%
\\
\>\AgdaComment{--        P [ x ≔ N ]}\<%
\\
\>\AgdaComment{--      ⇉⟨ \{!!\} ⟩}\<%
\\
\>\AgdaComment{--        M' [ x ≔ N' ]}\<%
\\
\>\AgdaComment{--      ∎⇉}\<%
\\
%
\\
\>\AgdaComment{-- lemma⇉Subst : \{N N' : FTerm\}(x : V)(M : FTerm) → Psubst⇉ \{N\} \{N'\} x M}\<%
\\
\>\AgdaComment{-- lemma⇉Subst \{N\} \{N'\} x M = \{!!\}}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- RelF : Functor}\<%
\\
\>\AgdaComment{-- RelF = tF |x| tF}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}


